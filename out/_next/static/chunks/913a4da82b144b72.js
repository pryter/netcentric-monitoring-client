(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>a]);var s=e.i(43476),l=e.i(71645);function a(){var e,a;let[n,t]=(0,l.useState)(null),[o,i]=(0,l.useState)(null),[r,d]=(0,l.useState)(null),[c,m]=(0,l.useState)("ws://localhost:8080/monitoring"),x=(0,l.useMemo)(()=>{var e,s;return o?{mon:null!=(e=null==o?void 0:o.connectionPool.filter(e=>"monitoring"===e.type))?e:[],users:null!=(s=null==o?void 0:o.connectionPool.filter(e=>"default"===e.type))?s:[]}:{mon:[],users:[]}},[null==o?void 0:o.connectionPool]),u=(0,l.useCallback)(e=>{null==n||n.send(JSON.stringify({type:"message",data:{group:"monitoring-action",name:"reset-room",data:{roomId:e}}}))},[n]);return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)("span",{className:"mr-2",children:"local:"}),(0,s.jsx)("input",{type:"radio",name:"server",id:"local",value:"local",defaultChecked:!0,onChange:e=>{m("ws://localhost:8080/monitoring")}}),(0,s.jsx)("span",{className:"mr-2 ml-4",children:"global:"}),(0,s.jsx)("input",{type:"radio",name:"server",id:"global",value:"global",onChange:e=>{m("wss://netcen-game-server-oc1.pryter.me/monitoring")}})]}),(0,s.jsxs)("div",{className:"relative flex flex-row space-x-2 max-w-[200px] mb-6",children:[(0,s.jsx)("input",{className:"border rounded-lg px-4 grow",type:"text",placeholder:"token",onChange:e=>{d(e.target.value)}}),(0,s.jsx)("button",{className:"border py-1 px-3 rounded-lg text-sm font-semibold cursor-pointer",onClick:()=>{let e=new WebSocket(c);e.onopen=s=>{t(e),e.send(JSON.stringify({type:"upgrade",data:{token:null!=r?r:"12345"}}))},e.onmessage=s=>{let l=JSON.parse(s.data);"monitoring-event"===l.data.group&&i(l.data.data),"server-response"===l.data.group&&console.log(l.data.data),"upgrade-success"==l.data.name&&e.send(JSON.stringify({type:"message",data:{group:"monitoring-action",name:"sub-mon-stream"}}))}},children:"Connect"})]}),(0,s.jsx)("h1",{className:"font-semibold mb-2",children:"Connection Pool"}),(0,s.jsxs)("p",{children:["Users ",(0,s.jsx)("span",{className:"font-semibold",children:null==(e=x.users)?void 0:e.length})," Monitor ",(0,s.jsx)("span",{className:"font-semibold",children:null==(a=x.mon)?void 0:a.length})]}),(0,s.jsx)("div",{className:"flex items-start p-4 border rounded-xl gap-4 overflow-x-auto",children:null==o?void 0:o.connectionPool.map(e=>{var l,a,n,t,o,i,r;return(0,s.jsxs)("div",{className:"flex flex-col border relative bg-white rounded-xl p-4",children:[(0,s.jsxs)("h1",{className:"top-1 absolute text-[8px]",children:["conn-id: ",e.id]}),"monitoring"===e.type?(0,s.jsx)("h1",{className:"mt-8 mb-4 font-semibold text-gray-500",children:"Monitoring Client"}):(0,s.jsxs)("div",{className:"flex flex-row space-x-2 mt-2",children:[(null==(l=e.user)?void 0:l.avatar)&&(0,s.jsx)("img",{src:null==(a=e.user)?void 0:a.avatar,alt:"avatar",className:"rounded-full",width:64,height:64}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("h1",{className:"text-xs",children:["userid: ",(0,s.jsx)("span",{className:"font-semibold",children:null==(n=e.user)?void 0:n.uid})]}),(0,s.jsxs)("h1",{className:"text-sm",children:["nickname: ",(0,s.jsx)("span",{className:"font-semibold",children:null==(t=e.user)?void 0:t.nickname})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("h1",{className:"text-sm",children:["level: ",null==(o=e.user)?void 0:o.level]}),(0,s.jsxs)("h1",{className:"text-sm",children:["score: ",null==(i=e.user)?void 0:i.score]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"font-semibold mt-2",children:"Connection detail"}),(0,s.jsxs)("h1",{className:"text-sm",children:["state: ",e.state]}),(0,s.jsxs)("h1",{className:"text-sm",children:["acc-type: ",e.type]})]})]},null!=(r=e.id)?r:"")})}),(0,s.jsx)("h1",{className:"font-semibold mb-2 mt-4",children:"Gameroom Registry"}),(0,s.jsx)("div",{className:"flex flex-row p-4 border rounded-xl gap-4 overflow-x-auto",children:null==o?void 0:o.roomReg.map(e=>(0,s.jsxs)("div",{className:"flex flex-wrap max-w-[400px] border p-2 rounded-xl space-x-2 space-y-1",children:[Object.entries(e).map(e=>{let[l,a]=e;return"string"==typeof a||"number"==typeof a?(0,s.jsxs)("div",{className:"bg-gray-100 rounded-full px-2",children:[(0,s.jsx)("span",{className:"text-gray-500 font-semibold",children:l}),": ",a]},l):null===a?(0,s.jsxs)("div",{className:"bg-gray-100 rounded-full px-2",children:[(0,s.jsx)("span",{className:"text-gray-500 font-semibold",children:l}),": ",(0,s.jsx)("span",{className:"text-amber-600",children:"null"})]},l):"players"===l?(0,s.jsxs)("div",{className:"px-1 mt-3",children:[(0,s.jsx)("h1",{className:"font-semibold",children:"Players"}),Object.values(a).map((e,l)=>(0,s.jsxs)("div",{style:{opacity:e.isDisconnected?.6:1},className:"flex flex-row space-x-2 mt-2",children:[(null==e?void 0:e.avatarUri)&&(0,s.jsx)("img",{src:e.avatarUri,alt:"avatar",className:"rounded-full grow-0 size-[64px]",width:64,height:64}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("h1",{className:"text-xs",children:["userid: ",(0,s.jsx)("span",{className:"font-semibold",children:e.id})]}),(0,s.jsxs)("h1",{className:"text-sm",children:["nickname: ",(0,s.jsx)("span",{className:"font-semibold",children:e.displayName})]}),(0,s.jsxs)("h1",{className:"text-sm",children:["match-score: ",(0,s.jsx)("span",{className:"font-semibold",children:e.score})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("h1",{className:"text-sm",children:["isReady: ",(0,s.jsx)("span",{className:"font-semibold",children:e.isReady?"true":"false"})]}),(0,s.jsxs)("h1",{className:"text-sm",children:["isDisconnected: ",(0,s.jsx)("span",{className:"font-semibold",children:e.isDisconnected?"true":"false"})]})]})]})]},l))]},l):"question"===l?(0,s.jsxs)("div",{className:"bg-gray-100 rounded-full px-2",children:[(0,s.jsx)("span",{className:"text-gray-500 font-semibold",children:l}),": ",a.problem.join(", ")," find ",a.target]},l):void 0}),(0,s.jsx)("div",{className:"mt-4 flex space-x-2 items-center",children:(0,s.jsx)("button",{className:"border py-1 px-3 rounded-xl text-sm font-semibold cursor-pointer",onClick:()=>{u(e.id)},children:"Reset States"})})]},e.id))})]})}}]);